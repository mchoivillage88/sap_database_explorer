import{j as t,p as M,B as u}from"./index-ng72XqJj.js";function X({table:d,relatedTables:p,allTables:j,onSelectTable:f}){const k=s=>{switch(s){case"one-to-one":return"#10b981";case"one-to-many":return"#3b82f6";case"many-to-one":return"#3b82f6";case"many-to-many":return"#a855f7"}},g=(s,x,e,n)=>{const c=e+Math.PI/2,l=s+Math.cos(c)*10,i=x+Math.sin(c)*10,r=s-Math.cos(c)*10,a=x-Math.sin(c)*10;return t.jsx("line",{x1:l,y1:i,x2:r,y2:a,stroke:n,strokeWidth:"2"})},m=(s,x,e,n)=>{const l=s-Math.cos(e+.5)*10,i=x-Math.sin(e+.5)*10,r=s-Math.cos(e-.5)*10,a=x-Math.sin(e-.5)*10;return t.jsxs("g",{children:[t.jsx("line",{x1:s,y1:x,x2:l,y2:i,stroke:n,strokeWidth:"2"}),t.jsx("line",{x1:s,y1:x,x2:r,y2:a,stroke:n,strokeWidth:"2"})]})},w=s=>j.find(e=>e.name===s)?.description||"",b=(s,x,e,n,o)=>{const c=Math.cos(e),l=Math.sin(e),i=n/2,r=o/2,a=Math.tan(e);let h,y;return Math.abs(c)>Math.abs(l)?(h=c>0?i:-i,y=h*a,Math.abs(y)>r&&(y=l>0?r:-r,h=y/a)):(y=l>0?r:-r,h=y/a,Math.abs(h)>i&&(h=c>0?i:-i,y=h*a)),{x:s+h,y:x+y}};return t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[t.jsx("h3",{className:"mb-4",children:"Entity Relationship Diagram"}),p.length===0?t.jsx("div",{className:"text-center text-gray-500 py-8",children:"No relationships defined for this table"}):t.jsxs("svg",{viewBox:"0 0 800 500",className:"mx-auto w-full h-auto",style:{maxWidth:"100%",minHeight:"300px"},children:[d.relationships.map((s,x)=>{const e=x*2*Math.PI/d.relationships.length-Math.PI/2,n=k(s.type),o=b(400,250,e,180,80),c=400+Math.cos(e)*210,l=250+Math.sin(e)*210,i=b(c,l,e+Math.PI,160,70),r=8,a={x:o.x+Math.cos(e)*r,y:o.y+Math.sin(e)*r},h={x:i.x-Math.cos(e)*r,y:i.y-Math.sin(e)*r};return t.jsxs("g",{children:[t.jsx("line",{x1:o.x,y1:o.y,x2:i.x,y2:i.y,stroke:n,strokeWidth:"2"}),s.type==="one-to-one"&&t.jsxs(t.Fragment,{children:[g(o.x,o.y,e,n),g(i.x,i.y,e+Math.PI,n)]}),s.type==="one-to-many"&&t.jsxs(t.Fragment,{children:[g(o.x,o.y,e,n),m(h.x,h.y,e+Math.PI,n)]}),s.type==="many-to-one"&&t.jsxs(t.Fragment,{children:[m(a.x,a.y,e,n),g(i.x,i.y,e+Math.PI,n)]}),s.type==="many-to-many"&&t.jsxs(t.Fragment,{children:[m(a.x,a.y,e,n),m(h.x,h.y,e+Math.PI,n)]})]},`${s.targetTable}-${x}`)}),t.jsxs("g",{style:{cursor:"pointer"},onClick:()=>f(d.name),children:[t.jsx("rect",{x:400-180/2,y:250-80/2,width:180,height:80,fill:"#1e40af",stroke:"#1e3a8a",strokeWidth:"2",rx:"6"}),t.jsx("text",{x:400,y:230,textAnchor:"middle",className:"text-sm",fill:"white",children:d.name}),t.jsx("text",{x:400,y:246,textAnchor:"middle",className:"text-xs",fill:"#bfdbfe",children:d.description}),d.typicalRecordCount&&(()=>{const s=M(d.typicalRecordCount);return t.jsx(t.Fragment,{children:t.jsx("foreignObject",{x:340,y:258,width:"120",height:"20",children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[t.jsx(u,{className:`${s.color} text-white text-xs`,style:{fontSize:"9px",height:"14px",lineHeight:"14px",display:"inline-block",padding:"0 3px"},children:s.label}),t.jsxs("span",{style:{fontSize:"12px",color:"#93c5fd",whiteSpace:"nowrap"},children:[d.typicalRecordCount," records"]})]})})})})()]}),d.relationships.map((s,x)=>{const e=x*2*Math.PI/d.relationships.length-Math.PI/2,n=400+Math.cos(e)*210,o=250+Math.sin(e)*210,c=k(s.type),l=w(s.targetTable),r=j.find(h=>h.name===s.targetTable)?.typicalRecordCount||"",a=r?M(r):null;return t.jsxs("g",{style:{cursor:"pointer"},onClick:()=>f(s.targetTable),children:[t.jsx("rect",{x:n-160/2,y:o-70/2,width:160,height:70,fill:c,fillOpacity:"0.1",stroke:c,strokeWidth:"2",rx:"6"}),t.jsx("text",{x:n,y:o-18,textAnchor:"middle",className:"text-sm",fill:c,children:s.targetTable}),t.jsx("text",{x:n,y:o-2,textAnchor:"middle",className:"text-xs",fill:"gray",style:{maxWidth:"150px"},children:l.length>20?l.substring(0,20)+"...":l}),a&&r&&t.jsx(t.Fragment,{children:t.jsx("foreignObject",{x:n-55,y:o+8,width:"110",height:"20",children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"3px"},children:[t.jsx(u,{className:`${a.color} text-white text-xs`,style:{fontSize:"8px",height:"12px",lineHeight:"12px",display:"inline-block",padding:"0 3px"},children:a.label}),t.jsxs("span",{style:{fontSize:"12px",color:"#6b7280",whiteSpace:"nowrap"},children:[r," records"]})]})})})]},`box-${s.targetTable}-${x}`)})]}),p.length>0&&t.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[t.jsx("p",{className:"text-sm text-gray-700 mb-3",children:"Relationship Notation:"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("svg",{width:"60",height:"30",children:[t.jsx("line",{x1:"10",y1:"15",x2:"50",y2:"15",stroke:"#10b981",strokeWidth:"2"}),t.jsx("line",{x1:"10",y1:"10",x2:"10",y2:"20",stroke:"#10b981",strokeWidth:"2"}),t.jsx("line",{x1:"50",y1:"10",x2:"50",y2:"20",stroke:"#10b981",strokeWidth:"2"})]}),t.jsx("span",{className:"text-sm text-gray-600",children:"One-to-One"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("svg",{width:"60",height:"30",children:[t.jsx("line",{x1:"10",y1:"15",x2:"50",y2:"15",stroke:"#3b82f6",strokeWidth:"2"}),t.jsx("line",{x1:"10",y1:"10",x2:"10",y2:"20",stroke:"#3b82f6",strokeWidth:"2"}),t.jsx("line",{x1:"50",y1:"15",x2:"44",y2:"10",stroke:"#3b82f6",strokeWidth:"2"}),t.jsx("line",{x1:"50",y1:"15",x2:"44",y2:"20",stroke:"#3b82f6",strokeWidth:"2"})]}),t.jsx("span",{className:"text-sm text-gray-600",children:"One-to-Many"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("svg",{width:"60",height:"30",children:[t.jsx("line",{x1:"10",y1:"15",x2:"50",y2:"15",stroke:"#3b82f6",strokeWidth:"2"}),t.jsx("line",{x1:"10",y1:"15",x2:"16",y2:"10",stroke:"#3b82f6",strokeWidth:"2"}),t.jsx("line",{x1:"10",y1:"15",x2:"16",y2:"20",stroke:"#3b82f6",strokeWidth:"2"}),t.jsx("line",{x1:"50",y1:"10",x2:"50",y2:"20",stroke:"#3b82f6",strokeWidth:"2"})]}),t.jsx("span",{className:"text-sm text-gray-600",children:"Many-to-One"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("svg",{width:"60",height:"30",children:[t.jsx("line",{x1:"10",y1:"15",x2:"50",y2:"15",stroke:"#a855f7",strokeWidth:"2"}),t.jsx("line",{x1:"10",y1:"15",x2:"16",y2:"10",stroke:"#a855f7",strokeWidth:"2"}),t.jsx("line",{x1:"10",y1:"15",x2:"16",y2:"20",stroke:"#a855f7",strokeWidth:"2"}),t.jsx("line",{x1:"50",y1:"15",x2:"44",y2:"10",stroke:"#a855f7",strokeWidth:"2"}),t.jsx("line",{x1:"50",y1:"15",x2:"44",y2:"20",stroke:"#a855f7",strokeWidth:"2"})]}),t.jsx("span",{className:"text-sm text-gray-600",children:"Many-to-Many"})]})]})]})]})}export{X as ERDiagram};
